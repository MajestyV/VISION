# User Guidance

## I. Writing in the front

The use of [anaconda](https://www.anaconda.com/) for environment management is highly recommended.

May the Conda be with you!

## II. Setting up working environment

Assuming you have listen to the Master MajestyV carefully, you may now have already gained the Conda (downloaded). Let's see the bright side of the Conda. For instance, a recommended procedure for basic environment set-up is given. The first step is to create a Conda environment:

```shell
$ conda create --name yourEnv python=3.10  # Python version of 3.10 is preferred
```

where `yourEnv` is the desired environment name for customization.

Entering the created environment by

```shell
$ conda activate yourEnv
```

Installing dependent packages by `conda install XXX` instead of `pip install XXX`, where `XXX` is the desired package. The `pip` command is effective, however, may sabotage the environment dependency. The `conda` command is better for it is tailored for virtual environment generated by anaconda.

This following is an example package installation command:

```shell
$ conda install numpy scipy matplotlib seaborn pandas xlrd ...
```

## III. Scripts

本代码内含了一系列方便用于光电子器件及硬件系统的数据分析模块，可以用过脚本进行快速调用分析。所有的脚本都可以在终端（terminal for unix-based OS or cmd for windows）中通过命令行调用。

首先，假设VISION包已经被下载到了`~/PycharmProjects`路径，使用者可以通过运行：

```shell
$ cd ~/PycharmProjects/VISION/scripts
```

进入到脚本所在的文件夹。然后，可以通过`python`命令调用脚本。以下是其中一部分脚本的使用方法。

### A. Frequency analysis (频谱分析)

```shell
$ python FrequencyAnalysis.py -h
usage: FrequencyAnalysis.py [-h] [--working_place -W] [--file_name -F] [--data_format -T] [--drop_out -D]
                            [--drop_out_ratio -R] [--window_func -W] [--fig_size -S] [--time_unit -TU]
                            [--freq_unit -FU] [--set_freq_range -SFR] [--freq_range -FR] [--power_spectrum_method -M]
                            [--figure_format -FF] [--figure_quality -DPI]

options:
  -h, --help            show this help message and exit
  --working_place -W    Working place
  --file_name -F        File name
  --data_format -T      File type
  --drop_out -D         Drop out zero frequency
  --drop_out_ratio -R   Drop out ratio
  --window_func -W      Window function
  --fig_size -S         Figure size
  --time_unit -TU       Time unit
  --freq_unit -FU       Frequency unit
  --set_freq_range -SFR
                        Set frequency range
  --freq_range -FR      Frequency range
  --power_spectrum_method -M
                        Power spectrum method
  --figure_format -FF   Figure format
  --figure_quality -DPI
                        Figure quality
```

Below is an example command:

```shell
$ python FrequencyAnalysis.py --file_name Empty --drop_out True --drop_out_ratio 0.05 --time_unit m --freq_unit M --set_freq_range True
```

### B. Device statistics (器件性能统计)

i. Conventional transistors

ii. Memristive transistors

```shell
$ python MemTransistorStatistic.py -h
usage: MemTransistorStatistic.py [-h] [--data_directory -P] [--saving_directory -S] [--voltage_unit -V]
                                 [--current_unit -I] [--mode -M] [--channel_type -C] [--analysis_subject -A]
                                 [--ON_range -ON] [--OFF_range -OFF] [--V_FullWidth -V_FullWidth]
                                 [--window_size -W] [--boundary_cond -B] [--Vth_eval_range -Vth]
                                 [--mem_eval_range -Mem] [--SS_eval_range -SS] [--heatmap -H [-H ...]]
                                 [--distribution -D [-D ...]] [-AN] [-CM colormap] [-CM_source colormap source]
                                 [-F format]

options:
  -h, --help            show this help message and exit
  --data_directory -P   Data directory
  --saving_directory -S
                        Saving directory
  --voltage_unit -V     Voltage unit
  --current_unit -I     Current unit
  --mode -M             Analysis mode
  --channel_type -C     Channel type
  --analysis_subject -A
                        Analysis subject
  --ON_range -ON        ON range
  --OFF_range -OFF      OFF range
  --V_FullWidth -V_FullWidth
                        V FullWidth
  --window_size -W      Window size
  --boundary_cond -B    Boundary condition
  --Vth_eval_range -Vth
                        Vth evaluation range
  --mem_eval_range -Mem
                        Memory evaluation range
  --SS_eval_range -SS   SS evaluation range
  --heatmap -H [-H ...]
                        Heatmap
  --distribution -D [-D ...]
                        Distribution
  -AN, --annot          Annotation on the heatmap
  -CM colormap, --colormap colormap
                        Colormap of the heatmap
  -CM_source colormap source, --colormap_source colormap source
                        Source of the colormap
  -F format, --format format
                        Formats of the figures to be saved
```

Below is an example command:

```shell
# -V_unit: Voltage unit, -I_unit: Current unit
# -AN: Annotation on the heatmap (如果不想在热力图里标出每个点的具体数值，只需要把`-AN`去掉即可)
# -CM: 给出色条的名称, -CM_source: 给出色条的来源, 自定义的输入custom, matplotlib自带的的输入default
$ python MemTransistorStatistic.py -V_unit V -I_unit A -AN -CM Blue_n_Red -CM_source custom
```

值得注意的是，有时候不同的指标会用不一样的单位，比如Vth用V，而SS用mV/dec。这时候，我们可以通过`-V_unit`和`-I_unit`来指定不同的单位，然后多跑两次就行。

## Problems & solutions

### i. ImportError: cannot import name ‘animation‘ from partially initialized module ‘matplotlib’

在Pycharm等IDE中运行正常的代码，在本地的cmd运行python code出现了一个错误：

```shell
ImportError: cannot import name ‘animation’ from partially initialized module ‘matplotlib’ (most likely due to a circular import)
```

这很可能是由于python调用了windows本机的python引起的。我本地的环境anaconda是放在E盘的。但报错显示的C盘里的matplotlib没有找到animation的模块。说明，import之后，系统到C盘去导入这个库，所以即使你重装升级都没用。此时，如果我们进入到conda环境中去查看默认的python版本的话，会发现：

```shell
$ where python
E:\Anaconda\Anaconda3\envs\python3.10\python.exe
C:\Users\Majes\AppData\Local\Microsoft\WindowsApps\python.exe
```

本机的python环境以及conda中的环境其实都被调用了。那么很简单，[把本机python卸载](https://answers.microsoft.com/zh-hans/windows/forum/all/%E6%97%A0%E6%B3%95%E5%8D%B8%E8%BD%BD%E6%9D%A5/8a4f4465-85af-415a-9526-8c148178b45a)完事。辣鸡Microsoft，Anaconda YYDS！！！

详情可参考：https://blog.csdn.net/weixin_42326545/article/details/127368928